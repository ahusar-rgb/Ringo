2023-09-02 14:20:41.902 [main] INFO  com.ringo.RingoApplication - Starting RingoApplication using Java 17.0.2 with PID 11485 (/Users/aleksandr/Ringo/build/classes/java/main started by aleksandr in /Users/aleksandr/Ringo)
2023-09-02 14:20:41.916 [main] INFO  com.ringo.RingoApplication - No active profile set, falling back to 1 default profile: "default"
2023-09-02 14:20:43.461 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-09-02 14:20:43.657 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 181 ms. Found 14 JPA repository interfaces.
2023-09-02 14:20:44.605 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2023-09-02 14:20:44.621 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2023-09-02 14:20:44.622 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2023-09-02 14:20:44.823 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2023-09-02 14:20:44.824 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2534 ms
2023-09-02 14:20:45.007 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2023-09-02 14:20:45.361 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@376b5cb2
2023-09-02 14:20:45.363 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2023-09-02 14:20:45.802 [main] INFO  liquibase.database - Set default schema name to public
2023-09-02 14:20:45.970 [main] INFO  liquibase.lockservice - Successfully acquired change log lock
2023-09-02 14:20:46.077 [main] INFO  liquibase.changelog - Reading resource: liquibase/change-logs/000-changelog.xml
2023-09-02 14:20:46.489 [main] INFO  liquibase.changelog - Reading resource: liquibase/change-logs/001-changelog.xml
2023-09-02 14:20:46.509 [main] INFO  liquibase.changelog - Reading resource: liquibase/change-logs/01-category.sql
2023-09-02 14:20:46.513 [main] INFO  liquibase.changelog - Reading resource: liquibase/change-logs/02-currency.sql
2023-09-02 14:20:46.515 [main] INFO  liquibase.changelog - Reading resource: liquibase/change-logs/09-get_distance.sql
2023-09-02 14:20:46.700 [main] INFO  liquibase.changelog - Reading from public.databasechangelog
2023-09-02 14:20:46.884 [main] INFO  liquibase.lockservice - Successfully released change log lock
2023-09-02 14:20:47.013 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2023-09-02 14:20:47.090 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.1.7.Final
2023-09-02 14:20:47.556 [main] INFO  SQL dialect - HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-09-02 14:20:49.025 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-09-02 14:20:49.038 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-09-02 14:20:54.589 [main] INFO  c.r.service.common.CurrencyExchanger - Updated exchange rates for currency: USD
2023-09-02 14:20:55.853 [main] INFO  c.r.service.common.CurrencyExchanger - Updated exchange rates for currency: EUR
2023-09-02 14:20:56.349 [main] INFO  c.r.service.common.CurrencyExchanger - Updated exchange rates for currency: UAH
2023-09-02 14:20:58.938 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4b3a6383, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@689c5fdc, org.springframework.security.web.context.SecurityContextHolderFilter@1e71b70d, org.springframework.security.web.header.HeaderWriterFilter@5a050bf9, org.springframework.web.filter.CorsFilter@65589d76, org.springframework.security.web.authentication.logout.LogoutFilter@7aa91a69, com.ringo.auth.JwtFilter@70a9f4b7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3c36f10b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3456e3b3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5bc971ef, org.springframework.security.web.session.SessionManagementFilter@4643d88c, org.springframework.security.web.access.ExceptionTranslationFilter@7bcbf479, org.springframework.security.web.access.intercept.AuthorizationFilter@28816098]
2023-09-02 14:20:59.442 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2023-09-02 14:20:59.457 [main] INFO  com.ringo.RingoApplication - Started RingoApplication in 18.215 seconds (process running for 19.329)
2023-09-02 14:20:59.561 [main] INFO  com.ringo.RingoApplication - 
----------------------------------------------------------
	Application 'Ringo' is running! Access URLs:
	Local: 		http://localhost:8080/
	External: 	http://127.0.0.1:8080/
	Profile(s): 	[]
----------------------------------------------------------
2023-09-02 14:21:09.879 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-09-02 14:21:09.880 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2023-09-02 14:21:09.882 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2023-09-02 14:21:09.960 [http-nio-8080-exec-2] INFO  c.ringo.controller.StripeController - Webhook from stripe received: {
  "id": "evt_3Nlrt2CkVoLPfCXz1tQfvbU2",
  "object": "event",
  "api_version": "2022-11-15",
  "created": 1693653669,
  "data": {
    "object": {
      "id": "pi_3Nlrt2CkVoLPfCXz1lFkSVqC",
      "object": "payment_intent",
      "amount": 2000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {
        }
      },
      "amount_received": 2000,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic",
      "client_secret": "pi_3Nlrt2CkVoLPfCXz1lFkSVqC_secret_g4RJBxOB8beYDjVdvkTPH5Ey5",
      "confirmation_method": "automatic",
      "created": 1693653668,
      "currency": "usd",
      "customer": null,
      "description": "(created by Stripe CLI)",
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": "ch_3Nlrt2CkVoLPfCXz1hPehJiA",
      "livemode": false,
      "metadata": {
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": "pm_1Nlrt2CkVoLPfCXzDEPgJRa7",
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": {
        "address": {
          "city": "San Francisco",
          "country": "US",
          "line1": "510 Townsend St",
          "line2": null,
          "postal_code": "94103",
          "state": "CA"
        },
        "carrier": null,
        "name": "Jenny Rosen",
        "phone": null,
        "tracking_number": null
      },
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "livemode": false,
  "pending_webhooks": 2,
  "request": {
    "id": "req_lbW2ynVU5cVqv6",
    "idempotency_key": "3d377389-a890-49a1-b4c4-36edcee6d76c"
  },
  "type": "payment_intent.succeeded"
}
2023-09-02 14:21:09.960 [http-nio-8080-exec-1] INFO  c.ringo.controller.StripeController - Webhook from stripe received: {
  "id": "evt_3Nlrt2CkVoLPfCXz1d3XkHVz",
  "object": "event",
  "api_version": "2022-11-15",
  "created": 1693653669,
  "data": {
    "object": {
      "id": "ch_3Nlrt2CkVoLPfCXz1hPehJiA",
      "object": "charge",
      "amount": 2000,
      "amount_captured": 2000,
      "amount_refunded": 0,
      "application": null,
      "application_fee": null,
      "application_fee_amount": null,
      "balance_transaction": "txn_3Nlrt2CkVoLPfCXz1WSfQBJq",
      "billing_details": {
        "address": {
          "city": null,
          "country": null,
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": null,
        "name": null,
        "phone": null
      },
      "calculated_statement_descriptor": "Stripe",
      "captured": true,
      "created": 1693653668,
      "currency": "usd",
      "customer": null,
      "description": "(created by Stripe CLI)",
      "destination": null,
      "dispute": null,
      "disputed": false,
      "failure_balance_transaction": null,
      "failure_code": null,
      "failure_message": null,
      "fraud_details": {
      },
      "invoice": null,
      "livemode": false,
      "metadata": {
      },
      "on_behalf_of": null,
      "order": null,
      "outcome": {
        "network_status": "approved_by_network",
        "reason": null,
        "risk_level": "normal",
        "risk_score": 10,
        "seller_message": "Payment complete.",
        "type": "authorized"
      },
      "paid": true,
      "payment_intent": "pi_3Nlrt2CkVoLPfCXz1lFkSVqC",
      "payment_method": "pm_1Nlrt2CkVoLPfCXzDEPgJRa7",
      "payment_method_details": {
        "card": {
          "brand": "visa",
          "checks": {
            "address_line1_check": null,
            "address_postal_code_check": null,
            "cvc_check": null
          },
          "country": "US",
          "exp_month": 9,
          "exp_year": 2024,
          "fingerprint": "W31KkhmRyzpFEbLS",
          "funding": "credit",
          "installments": null,
          "last4": "4242",
          "mandate": null,
          "network": "visa",
          "network_token": {
            "used": false
          },
          "three_d_secure": null,
          "wallet": null
        },
        "type": "card"
      },
      "receipt_email": null,
      "receipt_number": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xTjZiS1NDa1ZvTFBmQ1h6KKW1zKcGMgY30LQQf1c6LBYrsgGgyxUxjhCJlnXTCIo6WOsPFSxHLOUrUgcRffUZTVWCmk39hIlIexqF",
      "refunded": false,
      "review": null,
      "shipping": {
        "address": {
          "city": "San Francisco",
          "country": "US",
          "line1": "510 Townsend St",
          "line2": null,
          "postal_code": "94103",
          "state": "CA"
        },
        "carrier": null,
        "name": "Jenny Rosen",
        "phone": null,
        "tracking_number": null
      },
      "source": null,
      "source_transfer": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "livemode": false,
  "pending_webhooks": 2,
  "request": {
    "id": "req_lbW2ynVU5cVqv6",
    "idempotency_key": "3d377389-a890-49a1-b4c4-36edcee6d76c"
  },
  "type": "charge.succeeded"
}
2023-09-02 14:21:09.960 [http-nio-8080-exec-3] INFO  c.ringo.controller.StripeController - Webhook from stripe received: {
  "id": "evt_3Nlrt2CkVoLPfCXz19rOsf5a",
  "object": "event",
  "api_version": "2022-11-15",
  "created": 1693653668,
  "data": {
    "object": {
      "id": "pi_3Nlrt2CkVoLPfCXz1lFkSVqC",
      "object": "payment_intent",
      "amount": 2000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {
        }
      },
      "amount_received": 0,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic",
      "client_secret": "pi_3Nlrt2CkVoLPfCXz1lFkSVqC_secret_g4RJBxOB8beYDjVdvkTPH5Ey5",
      "confirmation_method": "automatic",
      "created": 1693653668,
      "currency": "usd",
      "customer": null,
      "description": "(created by Stripe CLI)",
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": null,
      "livemode": false,
      "metadata": {
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": null,
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": {
        "address": {
          "city": "San Francisco",
          "country": "US",
          "line1": "510 Townsend St",
          "line2": null,
          "postal_code": "94103",
          "state": "CA"
        },
        "carrier": null,
        "name": "Jenny Rosen",
        "phone": null,
        "tracking_number": null
      },
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "requires_payment_method",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "livemode": false,
  "pending_webhooks": 2,
  "request": {
    "id": "req_lbW2ynVU5cVqv6",
    "idempotency_key": "3d377389-a890-49a1-b4c4-36edcee6d76c"
  },
  "type": "payment_intent.created"
}
2023-09-02 14:21:09.995 [http-nio-8080-exec-3] ERROR c.r.exception.GlobalExceptionHandler - java.lang.NullPointerException: Cannot invoke "String.split(String, int)" because "sigHeader" is null
2023-09-02 14:21:09.995 [http-nio-8080-exec-2] ERROR c.r.exception.GlobalExceptionHandler - java.lang.NullPointerException: Cannot invoke "String.split(String, int)" because "sigHeader" is null
2023-09-02 14:21:09.995 [http-nio-8080-exec-1] ERROR c.r.exception.GlobalExceptionHandler - java.lang.NullPointerException: Cannot invoke "String.split(String, int)" because "sigHeader" is null
2023-09-02 14:21:55.537 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2023-09-02 14:21:55.543 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2023-09-02 14:21:55.548 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
